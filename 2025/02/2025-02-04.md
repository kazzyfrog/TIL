---
date created: 2025-02-05, 00:16
date modified: 2025-02-05, 00:40
---

## JavaScript で、タイムゾーンを考慮した日時を扱う場合

便利なのが、date-fns の v4.0 で追加された、date-fns/tz 今までは、date-fns と、date-fns-tz を組み合わせて実装していたが、v4.0 ですべての date-fns 関数で動作するパッケージがサポートされた

これにより、自動で動作する環境のタイムゾーンにならずに、制御可能になった！
https://zenn.dev/chot/articles/11edd3d6424211

## 遭遇したトラブル

現在、ブログアプリを作成しています。
記事の投稿時刻が、 下記です。 date_created: 2025-02-04, 23:25

date-fns を使っていて、ローカルでは、「20 分前」で正常です。
本番では、「約９時間後」となっています。

既存の記事が多数あるので、フォーマットは変更したくないです。

まず、原因は、おそらくタイムゾーンの違いですよね？
ローカルでは正常に動作するのに、本番の cloudflare では、9 時間後って表示されるので。

なので、解決策は、これですか？

- 投稿時刻を US に変換して比較する
- 現在時刻を日本時間に変換して比較する

Cloudflare はデフォルトで UTC（協定世界時）を使用しているため、日本時間（JST）との 9 時間の差が生じています。
